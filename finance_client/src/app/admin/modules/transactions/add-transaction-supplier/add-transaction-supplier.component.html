<section class="content">
  <div class="content-block">
    <div class="block-header">
      <!-- breadcrumb -->
      <app-breadcrumb
        [title]="'Accrual suppliers'"
        [items]="['Home', 'Transactions']"
        [active_item]="'Accrual suppliers'"
      >
      </app-breadcrumb>
    </div>
    <!-- Widgets -->
    <app-gen-widgets></app-gen-widgets>
    <!-- #END# Widgets -->
    <div class="row clearfix">
      <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Supplier information</h2>
          </div>
          <div class="body">
            <div class="header">
              <h2>{{ formTitle }}</h2>
            </div>
            <form class="m-4" [formGroup]="Form">
              <div
                class="chat-history"
                id="chat-conversation"
                style="position: relative; min-height: 300px; max-height: 420px"
                [perfectScrollbar]
              >
                <!-- <div style="position: relative; min-height: 380px;" [perfectScrollbar]> -->
                <div class="row m-r-10">
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Supplier name</mat-label>
                      <input formControlName="supplierName" matInput readonly />
                      <button
                        (click)="suppliersLookup()"
                        mat-icon-button
                        matSuffix
                        [attr.aria-label]="'Hide password'"
                      >
                        <mat-icon>search</mat-icon>
                      </button>
                      <mat-error
                        *ngIf="
                          Form.get('supplierName').hasError('supplierName') &&
                          Form.get('supplierName').touched
                        "
                      >
                        Please enter supplier name
                      </mat-error>
                    </mat-form-field>
                  </div>

                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Supplier Acc</mat-label>
                      <input formControlName="supplierAc" matInput readonly />
                      <button
                        (click)="branchCodeLookup()"
                        mat-icon-button
                        matSuffix
                        [attr.aria-label]="'Hide password'"
                      >
                        <mat-icon>search</mat-icon>
                      </button>
                      <mat-error
                        *ngIf="
                          Form.get('supplierAc').hasError('supplierAc') &&
                          Form.get('supplierAc').touched
                        "
                      >
                        Please enter supplier acc
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Accrual Account Name</mat-label>
                      <input
                        matInput
                        formControlName="accrualAccountName"
                        required
                        readonly
                      />

                      <mat-icon matSuffix (click)="accrualBranchCodeLookup()"
                        >search</mat-icon
                      >
                      <mat-error
                        *ngIf="
                          Form.get('accrualAccountName').hasError('required') &&
                          Form.get('accrualAccountName').touched
                        "
                      >
                        Please enter accrual account name
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Accrual Account</mat-label>
                      <input
                        matInput
                        formControlName="accrualAccount"
                        required
                        readonly
                      />

                      <mat-icon matSuffix (click)="accrualBranchCodeLookup()"
                        >search</mat-icon
                      >
                      <mat-error
                        *ngIf="
                          Form.get('accrualAccount').hasError('required') &&
                          Form.get('accrualAccount').touched
                        "
                      >
                        Please enter accrual account
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Accrual amount</mat-label>

                      <input
                        matInput
                        type="number"
                        formControlName="acrualAmount"
                        required
                      />
                      <mat-icon matSuffix>attach_money</mat-icon>
                      <mat-error
                        *ngIf="
                          Form.get('acrualAmount').hasError('required') &&
                          Form.get('acrualAmount').touched
                        "
                      >
                        Please enter gross amount
                      </mat-error>
                    </mat-form-field>
                  </div>

                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Acrual Period</mat-label>

                      <input
                        matInput
                        type="number"
                        formControlName="acrualPeriod"
                        required
                      />
                      <mat-icon matSuffix>attach_money</mat-icon>
                      <mat-error
                        *ngIf="
                          Form.get('acrualPeriod').hasError('required') &&
                          Form.get('acrualPeriod').touched
                        "
                      >
                        Please enter acrual period (months)</mat-error
                      >
                    </mat-form-field>
                  </div>
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field
                      class="example-full-width"
                      appearance="fill"
                    >
                      <mat-label>Acrual Description</mat-label>

                      <textarea
                        matInput
                        formControlName="acrualDescription"
                        required
                      ></textarea>

                      <mat-icon matSuffix>pen</mat-icon>
                      <mat-error
                        *ngIf="
                          Form.get('acrualDescription').hasError('required') &&
                          Form.get('acrualDescription').touched
                        "
                      >
                        Please enter acrual description</mat-error
                      >
                    </mat-form-field>
                  </div>
                </div>

                <!-- <div class="row m-t-10" *ngIf="addSupplier">
                                    <div class="d-flex justify-content-center">
                                       <img src="assets/images/gif.gif" style="display: block; margin: auto;width: 50px;" />
                                    </div>
                                 </div> -->
              </div>

              <div class="row m-t-10">
                <div
                  class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2 float-left"
                >
                  <div class="float-right">
                    <button
                      class="btn-space"
                      [disabled]="!Form.valid"
                      (click)="onSubmit()"
                      mat-raised-button
                      color="primary"
                    >
                      Submit
                    </button>
                    <button type="button" mat-button>Cancel</button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="col-xl-9 col-lg-9 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Accrual suppliers</h2>
          </div>
          <div class="body">
            <div class="row">
              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="body">
                  <div class="table-responsive">
                    <div class="materialTableHeader">
                      <div class="row">
                        <div class="col-8">
                          <ul class="header-buttons-left ms-0">
                            <li class="dropdown">
                              <h2>Accrual suppliers</h2>
                            </li>
                            <li class="dropdown m-l-20">
                              <label for="search-input"
                                ><i class="material-icons search-icon"
                                  >search</i
                                ></label
                              >
                              <input
                                placeholder="Filter..."
                                type="text"
                                (keyup)="applyFilter($event)"
                                #filter
                                class="browser-default search-field"
                                aria-label="Search box"
                              />
                            </li>
                            <li>
                              <div class="m-l-10" matTooltip="ADD">
                                <button
                                  mat-mini-fab
                                  color="primary"
                                  (click)="addAccrualSupplier()"
                                >
                                  <mat-icon class="col-white">add</mat-icon>
                                </button>
                              </div>
                            </li>
                            <li>
                              <div class="m-l-10" matTooltip="REFRESH">
                                <button
                                  mat-mini-fab
                                  color="primary"
                                  (click)="refresh()"
                                >
                                  <mat-icon class="col-white">refresh</mat-icon>
                                </button>
                              </div>
                            </li>
                            <!-- <li>
                                                  <div class="m-l-10" [hidden]=!selection.hasValue() matTooltip="DELETE">
                                                    <button mat-mini-fab color="warn">
                                                      <mat-icon class="col-white">delete
                                                      </mat-icon>
                                                    </button>
                                                  </div>
                                                </li> -->
                          </ul>
                        </div>
                        <div class="col-4">
                          <ul class="header-buttons">
                            <li>
                              <div
                                class="export-button m-l-10"
                                matTooltip="XLSX"
                              >
                                <img
                                  src="assets/images/icons/xlsx.png"
                                  alt=""
                                  (click)="
                                    exporter.exportTable('xlsx', {
                                      fileName: 'assets-list',
                                      sheet: 'sheet1'
                                    })
                                  "
                                />
                              </div>
                            </li>
                            <li>
                              <div
                                class="export-button m-l-10"
                                matTooltip="CSV"
                              >
                                <img
                                  src="assets/images/icons/csv.png"
                                  alt=""
                                  (click)="exporter.exportTable('csv')"
                                />
                              </div>
                            </li>
                            <li>
                              <div
                                class="export-button m-l-10"
                                matTooltip="JSON"
                              >
                                <img
                                  src="assets/images/icons/json.png"
                                  alt=""
                                  (click)="exporter.exportTable('json')"
                                />
                              </div>
                            </li>
                            <li>
                              <div
                                class="export-button m-l-10"
                                matTooltip="TXT"
                              >
                                <img
                                  src="assets/images/icons/txt.png"
                                  alt=""
                                  (click)="exporter.exportTable('txt')"
                                />
                              </div>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <mat-table
                      #table
                      matTableExporter
                      [dataSource]="dataSource"
                      matSort
                      class="mat-cell"
                      #exporter="matTableExporter"
                    >
                      <!-- ID Column -->
                      <ng-container matColumnDef="id">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-4"
                          >Id</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-4"
                        >
                          {{ row.id }}</mat-cell
                        >
                      </ng-container>

                      <ng-container matColumnDef="supplierName">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-30"
                          >SupplierName
                        </mat-header-cell>
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-30"
                        >
                          {{ row.supplierName }}
                        </mat-cell>
                      </ng-container>
                      <ng-container matColumnDef="supplierAc">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-30"
                          >SupplierAc</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-30"
                        >
                          {{ row.supplierAc }}</mat-cell
                        >
                      </ng-container>

                      <ng-container matColumnDef="acrualAmount">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-25"
                          >AcrualAmount</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-25"
                        >
                          {{ row.acrualAmount | currency: "UGX: " }}</mat-cell
                        >
                      </ng-container>

                      <ng-container matColumnDef="accrualAccountName">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-25"
                          >A.AccountName</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-25"
                        >
                          {{ row.accrualAccountName }}</mat-cell
                        >
                      </ng-container>
                      <ng-container matColumnDef="accrualAccount">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-25"
                          >A.Account</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-25"
                        >
                          {{ row.accrualAccount }}</mat-cell
                        >
                      </ng-container>
                      <ng-container matColumnDef="acrualPeriod">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-15"
                          >AcrualPeriod</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-15"
                        >
                          {{ row.acrualPeriod }} months</mat-cell
                        >
                      </ng-container>
                      <ng-container matColumnDef="acrualDescription">
                        <mat-header-cell
                          *matHeaderCellDef
                          mat-sort-header
                          class="column-nowrap tbl-col-width-per-40"
                          >AcrualDescription</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row"
                          class="column-nowrap tbl-col-width-per-40"
                        >
                          {{ row.acrualDescription }}</mat-cell
                        >
                      </ng-container>

                      <ng-container matColumnDef="actions">
                        <mat-header-cell
                          *matHeaderCellDef
                          class="column-nowrap tbl-col-width-per-30"
                          >Actions</mat-header-cell
                        >
                        <mat-cell
                          *matCellDef="let row; let i = index"
                          class="column-nowrap tbl-col-width-per-30"
                        >
                          <button
                            class="badge badge-solid-purple btn btn btn-sm m-1"
                            (click)="$event.stopPropagation()"
                            (click)="viewSupplierTransactions(row)"
                          >
                            <i class="fas fa-eye"></i>&nbsp;View details
                          </button>

                          <button
                            mat-icon-button
                            color="accent"
                            (click)="$event.stopPropagation()"
                            (click)="updateAccrualSupplier(row)"
                            class="tbl-action-btn"
                          >
                            <app-feather-icons
                              [icon]="'edit'"
                              [class]="'tbl-fav-edit'"
                            >
                            </app-feather-icons>
                          </button>
                          <button
                            mat-icon-button
                            color="accent"
                            (click)="$event.stopPropagation()"
                            (click)="customWithFunction(row)"
                            class="tbl-action-btn"
                          >
                            <app-feather-icons
                              [icon]="'trash-2'"
                              [class]="'tbl-fav-delete'"
                            ></app-feather-icons>
                          </button>
                        </mat-cell>
                      </ng-container>

                      <!-- <ng-container matColumnDef="action">
                                            <mat-header-cell *matHeaderCellDef mat-sort-header>Action</mat-header-cell>
                                            <mat-cell *matCellDef="let row" (click)="onSelect(row)"> </mat-cell>
                                          </ng-container>                   -->

                      <mat-header-row
                        *matHeaderRowDef="displayedColumns"
                      ></mat-header-row>
                      <!-- <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row> -->
                      <mat-row
                        *matRowDef="let row; columns: displayedColumns"
                        (click)="updateAccrualSupplier(row)"
                        [style.cursor]="'pointer'"
                        matRipple
                      >
                      </mat-row>
                      <mat-cell *matNoDataRow colspan="4">
                        No data matching the filter "{{
                          input.value
                        }}"</mat-cell
                      >
                    </mat-table>
                    <!-- Loading spinner -->
                    <div *ngIf="isLoading" class="tbl-spinner">
                      <mat-progress-spinner
                        color="primary"
                        [diameter]="40"
                        mode="indeterminate"
                      >
                      </mat-progress-spinner>
                    </div>

                    <mat-paginator
                      [pageSize]="10"
                      [pageSizeOptions]="[2, 5, 10, 20, 30, 40, 50, 100]"
                      aria-label="Select page of users"
                    ></mat-paginator>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
